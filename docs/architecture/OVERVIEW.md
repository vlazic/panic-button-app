# Arhitektura Sistema - Pregled

## High-Level Dijagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PANIC BUTTON ARHITEKTURA                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚   KLIJENTI                      BACKEND                    EKSTERNI SERVISI    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚   PWA       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   CONVEX    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  TELEGRAM   â”‚       â”‚
â”‚   â”‚  (React)    â”‚   WebSocket  â”‚   Backend   â”‚   HTTP     â”‚    API      â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                            â”‚                                          â”‚
â”‚         â”‚                            â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚         â”‚ HTTPS                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   TWILIO    â”‚       â”‚
â”‚         â”‚                            â”‚   HTTP             â”‚   (SMS)     â”‚       â”‚
â”‚         â–¼                            â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚   â”‚   VERCEL    â”‚              â”‚  CONVEX DB  â”‚                                  â”‚
â”‚   â”‚   (CDN)     â”‚              â”‚ (Real-time) â”‚                                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Komponente

### 1. Frontend (PWA)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PWA (Progressive Web App)                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  FRAMEWORK: Next.js 14 (App Router)                                             â”‚
â”‚  UI: React 18 + TailwindCSS                                                     â”‚
â”‚  STATE: Convex React hooks (useQuery, useMutation)                              â”‚
â”‚                                                                                 â”‚
â”‚  KARAKTERISTIKE:                                                                â”‚
â”‚  âœ“ Installable na home screen                                                   â”‚
â”‚  âœ“ Offline support (service worker)                                             â”‚
â”‚  âœ“ Real-time updates (WebSocket)                                                â”‚
â”‚  âœ“ Responsive design (mobile-first)                                             â”‚
â”‚  âœ“ Geolocation API                                                              â”‚
â”‚                                                                                 â”‚
â”‚  KLJUÄŒNE STRANICE:                                                              â”‚
â”‚  â€¢ /            â†’ Login (PIN/SMS)                                               â”‚
â”‚  â€¢ /panic       â†’ Panic button screen                                           â”‚
â”‚  â€¢ /alarm/:id   â†’ Detalji alarma                                                â”‚
â”‚  â€¢ /admin       â†’ Admin panel (pun sistem)                                      â”‚
â”‚  â€¢ /shifts      â†’ Raspored smena (pun sistem)                                   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Backend (Convex)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONVEX BACKEND                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  ZAÅ TO CONVEX:                                                                  â”‚
â”‚  âœ“ Zero-config real-time subscriptions                                          â”‚
â”‚  âœ“ TypeScript first                                                             â”‚
â”‚  âœ“ Serverless (auto-scaling)                                                    â”‚
â”‚  âœ“ Transakcije (ACID)                                                           â”‚
â”‚  âœ“ Scheduled functions (cron)                                                   â”‚
â”‚  âœ“ File storage                                                                 â”‚
â”‚  âœ“ Generous free tier                                                           â”‚
â”‚                                                                                 â”‚
â”‚  FUNKCIJE:                                                                      â”‚
â”‚  â”œâ”€â”€ queries/       â†’ Read operacije (real-time)                                â”‚
â”‚  â”œâ”€â”€ mutations/     â†’ Write operacije                                           â”‚
â”‚  â”œâ”€â”€ actions/       â†’ External API calls (Telegram, Twilio)                     â”‚
â”‚  â”œâ”€â”€ scheduled/     â†’ Cron jobs (eskalacija, podsjetnici)                       â”‚
â”‚  â””â”€â”€ internal/      â†’ Server-only funkcije                                      â”‚
â”‚                                                                                 â”‚
â”‚  REAL-TIME PATTERN:                                                             â”‚
â”‚  Frontend koristi useQuery() koji automatski prima updates                      â”‚
â”‚  kada se podaci promene u bazi.                                                 â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Telegram Bot

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELEGRAM INTEGRACIJA                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  ULOGA: Pouzdan kanal za notifikacije                                           â”‚
â”‚                                                                                 â”‚
â”‚  FLOW:                                                                          â”‚
â”‚                                                                                 â”‚
â”‚  1. ALARM KREIRAN                                                               â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  2. Convex action poziva Telegram API                                           â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  3. Bot Å¡alje poruku u grupu                                                    â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  4. Responderi vide notifikaciju                                                â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  5. Klik na link â†’ otvara PWA                                                   â”‚
â”‚                                                                                 â”‚
â”‚  PORUKA FORMAT:                                                                 â”‚
â”‚  ğŸš¨ ALARM                                                                       â”‚
â”‚  ğŸ“ [Maps link]                                                                 â”‚
â”‚  ğŸ’¬ "Kratka poruka"                                                             â”‚
â”‚  ğŸ‘† Otvori: [app link]                                                          â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow

### Slanje alarma

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SLANJE ALARMA - DATA FLOW                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  1. KORISNIK                                                                    â”‚
â”‚     â”‚  DrÅ¾i panic button 3 sekunde                                              â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  2. PWA                                                                         â”‚
â”‚     â”‚  Uzima GPS lokaciju                                                       â”‚
â”‚     â”‚  Poziva mutation: createAlarm()                                           â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  3. CONVEX MUTATION                                                             â”‚
â”‚     â”‚  Kreira alarm u bazi                                                      â”‚
â”‚     â”‚  Status: ACTIVE                                                           â”‚
â”‚     â”‚  Zakazuje eskalaciju (90s)                                                â”‚
â”‚     â”‚  Triggeruje action za Telegram                                            â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  4. CONVEX ACTION                                                               â”‚
â”‚     â”‚  HTTP POST â†’ Telegram API                                                 â”‚
â”‚     â”‚  Å alje poruku u grupu                                                     â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  5. TELEGRAM                                                                    â”‚
â”‚     â”‚  Dostavlja notifikaciju svim Älanovima                                    â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  6. RESPONDERI                                                                  â”‚
â”‚     â”‚  Vide notifikaciju                                                        â”‚
â”‚     â”‚  Klik â†’ otvara PWA                                                        â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  7. PWA (useQuery)                                                              â”‚
â”‚     â”‚  Real-time subscription na alarm                                          â”‚
â”‚     â”‚  Prikazuje "Preuzimam" dugme                                              â”‚
â”‚     â”‚                                                                           â”‚
â”‚     â–¼                                                                           â”‚
â”‚  8. PREUZIMANJE                                                                 â”‚
â”‚        Mutation: takeAlarm()                                                    â”‚
â”‚        Status: ACTIVE â†’ TAKEN                                                   â”‚
â”‚        Svi povezani klijenti vide update                                        â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Real-time Updates

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REAL-TIME MEHANIZAM                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  Convex koristi WebSocket za real-time sync:                                    â”‚
â”‚                                                                                 â”‚
â”‚     KLIJENT A                    CONVEX                    KLIJENT B            â”‚
â”‚         â”‚                           â”‚                           â”‚               â”‚
â”‚         â”‚â”€â”€ useQuery(getAlarms) â”€â”€â”€â–ºâ”‚                           â”‚               â”‚
â”‚         â”‚â—„â”€â”€ Initial data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚               â”‚
â”‚         â”‚                           â”‚                           â”‚               â”‚
â”‚         â”‚                           â”‚â—„â”€â”€ mutation(create) â”€â”€â”€â”€â”€â”€â”‚               â”‚
â”‚         â”‚                           â”‚                           â”‚               â”‚
â”‚         â”‚â—„â”€â”€ WebSocket push â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚               â”‚
â”‚         â”‚    (novi alarm)           â”‚                           â”‚               â”‚
â”‚         â”‚                           â”‚                           â”‚               â”‚
â”‚    UI AUTOMATSKI                    â”‚                           â”‚               â”‚
â”‚    AÅ½URIRAN                         â”‚                           â”‚               â”‚
â”‚                                                                                 â”‚
â”‚  PREDNOSTI:                                                                     â”‚
â”‚  â€¢ Nema polling-a                                                               â”‚
â”‚  â€¢ Nema manual refresh-a                                                        â”‚
â”‚  â€¢ Optimistic updates                                                           â”‚
â”‚  â€¢ Automatic reconnection                                                       â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Eskalacija

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESKALACIJA - SCHEDULED FUNCTIONS                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  T = 0 (Alarm kreiran)                                                          â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚  â†’ Notifikacija: Responderi na smeni                                         â”‚
â”‚  â”‚  â†’ Zakazano: escalateLevel1 za T+90s                                         â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”œâ”€â”€ Ako neko preuzme â†’ CANCEL scheduled job                                    â”‚
â”‚  â”‚                                                                              â”‚
â”‚  T = 90s (Level 1 eskalacija)                                                   â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚  â†’ Notifikacija: SVI responderi                                              â”‚
â”‚  â”‚  â†’ Zakazano: escalateLevel2 za T+60s                                         â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”œâ”€â”€ Ako neko preuzme â†’ CANCEL scheduled job                                    â”‚
â”‚  â”‚                                                                              â”‚
â”‚  T = 150s (Level 2 eskalacija)                                                  â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚  â†’ Notifikacija: SVI Älanovi grupe                                           â”‚
â”‚  â”‚  â†’ Alert adminu: "KRITIÄŒNO - niko ne reaguje"                                â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â””â”€â”€ Dalje praÄ‡enje manuelno od strane admina                                   â”‚
â”‚                                                                                 â”‚
â”‚  CONVEX IMPLEMENTACIJA:                                                         â”‚
â”‚  ctx.scheduler.runAfter(90000, internal.escalation.level1, { alarmId })         â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Bezbednosni slojevi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEZBEDNOST                                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  LAYER 1: TRANSPORT                                                             â”‚
â”‚  â”œâ”€â”€ HTTPS everywhere (Vercel + Convex)                                         â”‚
â”‚  â”œâ”€â”€ TLS 1.3                                                                    â”‚
â”‚  â””â”€â”€ HSTS headers                                                               â”‚
â”‚                                                                                 â”‚
â”‚  LAYER 2: AUTENTIFIKACIJA                                                       â”‚
â”‚  â”œâ”€â”€ PoC: ZajedniÄki PIN                                                        â”‚
â”‚  â””â”€â”€ Full: JWT + SMS verifikacija                                               â”‚
â”‚                                                                                 â”‚
â”‚  LAYER 3: AUTORIZACIJA                                                          â”‚
â”‚  â”œâ”€â”€ Role-based (ADMIN, RESPONDER, RODITELJ, DETE)                              â”‚
â”‚  â””â”€â”€ Convex middleware proverava role pre svake operacije                       â”‚
â”‚                                                                                 â”‚
â”‚  LAYER 4: RATE LIMITING                                                         â”‚
â”‚  â”œâ”€â”€ SMS: 3/sat, 10/dan po broju                                                â”‚
â”‚  â”œâ”€â”€ PIN: 5 pokuÅ¡aja, lockout 1h                                                â”‚
â”‚  â””â”€â”€ Panic: 5min cooldown                                                       â”‚
â”‚                                                                                 â”‚
â”‚  LAYER 5: AUDIT                                                                 â”‚
â”‚  â””â”€â”€ Sve admin akcije se loguju                                                 â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## PoC vs Full System Arhitektura

### PoC (Minimalno)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PoC ARHITEKTURA                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚    PWA      â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚   CONVEX    â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  TELEGRAM   â”‚                 â”‚
â”‚   â”‚   (React)   â”‚        â”‚   (1 table) â”‚        â”‚    BOT      â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                 â”‚
â”‚   JEDNOSTAVNOST:                                                                â”‚
â”‚   â€¢ 1 tabela (alarms)                                                           â”‚
â”‚   â€¢ 1 Telegram grupa                                                            â”‚
â”‚   â€¢ PIN auth (svi dele isti)                                                    â”‚
â”‚   â€¢ Nema smena, nema uloga                                                      â”‚
â”‚   â€¢ Nema eskalacije                                                             â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Full System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FULL SYSTEM ARHITEKTURA                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚    PWA      â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚   CONVEX    â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  TELEGRAM   â”‚                 â”‚
â”‚   â”‚  (React)    â”‚        â”‚ (9 tabela)  â”‚        â”‚    BOT      â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                       â”‚                                               â”‚
â”‚         â”‚                       â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   TWILIO    â”‚                 â”‚
â”‚         â”‚                                       â”‚   (SMS)     â”‚                 â”‚
â”‚         â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                                                                       â”‚
â”‚         â–¼                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚   â”‚   VERCEL    â”‚                                                               â”‚
â”‚   â”‚   (CDN)     â”‚                                                               â”‚
â”‚   â”‚  + CF Pages â”‚                                                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚                                                                                 â”‚
â”‚   KOMPLEKSNOST:                                                                 â”‚
â”‚   â€¢ 9 tabela                                                                    â”‚
â”‚   â€¢ Multi-group                                                                 â”‚
â”‚   â€¢ SMS verifikacija                                                            â”‚
â”‚   â€¢ 4 uloge                                                                     â”‚
â”‚   â€¢ Sistem smena                                                                â”‚
â”‚   â€¢ 3-tier eskalacija                                                           â”‚
â”‚   â€¢ Admin panel                                                                 â”‚
â”‚   â€¢ Statistike                                                                  â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Skalabilnost

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SKALABILNOST                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  CONVEX:                                                                        â”‚
â”‚  â€¢ Automatski skalira                                                           â”‚
â”‚  â€¢ Serverless - plati po koriÅ¡Ä‡enju                                             â”‚
â”‚  â€¢ Do 10M funkcijskih poziva/mesec (free tier)                                  â”‚
â”‚                                                                                 â”‚
â”‚  VERCEL:                                                                        â”‚
â”‚  â€¢ CDN sa 100+ edge lokacija                                                    â”‚
â”‚  â€¢ Automatski skalira                                                           â”‚
â”‚  â€¢ Generous free tier za manje projekte                                         â”‚
â”‚                                                                                 â”‚
â”‚  TELEGRAM:                                                                      â”‚
â”‚  â€¢ PraktiÄno neograniÄen                                                        â”‚
â”‚  â€¢ Rate limit: 30 poruka/sek po botu                                            â”‚
â”‚  â€¢ Za viÅ¡e Å¡kola: queue sistem ili viÅ¡e botova                                  â”‚
â”‚                                                                                 â”‚
â”‚  PROCENA KAPACITETA:                                                            â”‚
â”‚  â€¢ 1 Å¡kola (50 Älanova): Bez problema na free tier                              â”‚
â”‚  â€¢ 10 Å¡kola (500 Älanova): ~$50-100/mesec                                       â”‚
â”‚  â€¢ 100 Å¡kola (5000 Älanova): ~$300-500/mesec + dedicated support                â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Dokument kreiran: Januar 2025*
